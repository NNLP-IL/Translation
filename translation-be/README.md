# Translation Application


---

# Table of contents
- [Translation Application](#translation-application)
- [Table of contents](#table-of-contents)
  - [1. Overview](#1-overview)
  - [2. API Routes](#2-api-routes)
    - [2.1 Translation Routes](#21-translation-routes)
      - [routes prefix: /api/](#routes-prefix-api)
      - [Endpoint: `/translate_sentences`](#endpoint-translate_sentences)
    - [2.4 Named Entity Recognition (NER) Routes](#24-named-entity-recognition-ner-routes)
      - [Endpoint: `/entity_extract`](#endpoint-entity_extract)
  - [4. Application Monitoring Integration](#4-application-monitoring-integration)
    - [Overview](#overview)
    - [OpenTelemetry Integration](#opentelemetry-integration)
    - [ELK Stack](#elk-stack)
      - [Kibana Dashboards](#kibana-dashboards)

---



## 1. Overview

This application provides functionalities for translation, transliteration, and language detection. 
- API documentation at: `{API_URL}/docs` 

## 2. API Routes

### 2.1 Translation Routes
#### routes prefix: /api/

#### Endpoint: `/translate_sentences`

- **Method:** POST
- **Description:** Translates multiple sentences from a source language to a target language.
- **Request Body:**
  ```json
  {
    "translate_direction": "he2ar", // or "ar2he"
    "sentences": ["sentence1", "sentence2"],
    "entity_alignment": true
  }

#### StreamingResponse:
The response is a streaming event that continuously sends translated sentences in JSON format.
- **Media Type:** text/event-stream
- **Purpose:** Allows continuous streaming of data.
- **Functionality:** The `event_generator` function yields each translated sentence as it is processed.
- **Handling Disconnection:** If the client disconnects, the streaming will stop automatically.

### 2.2 Transliteration Routes


#### Endpoint: `/transliterate?source={source}&target={target}'`
- **Method:** GET
- **Description:** Transliterates content from a source language to a target language.
- **Request Body:**
  ```json
  {
    "content": "text to be transliterated"
  }

### 2.3 Language Detection Routes

#### Endpoint: `/detection`

- **Method:** POST
- **Description:** Detects the language of the provided text content.
- **Request Body:**
  ```json
  {
    "content": "text to detect language"
  }
- **Response Format:**
  ```json
  {
    "language": {language: str, display_text: str, country: Optional[str] = None},
    "words": "`input_words`"
  } 
  ```

### 2.4 Named Entity Recognition (NER) Routes

#### Endpoint: `/entity_extract`

- **Method:** POST
- **Description:** Extracts named entities from the provided text in either Hebrew or Arabic, based on the specified language.
- **Request Body:**
  ```json
  {
    "language": "he",  // or "ar"
    "text": "Sample text to extract entities from",
    "split_sentences": true
  }

#### Endpoint: `/entity_extract/tagging_map`

- **Method:** GET
- **Description:** Returns the tagging map used for entity extraction. This map defines how entity types are tagged in the extraction model.
- **Response Format:**
  ```json
  {
    "PERSON": "Person tag",
    "LOCATION": "Location tag",
    ...
  }

## 3. Setup

Instructions for setting up the application both locally for debugging purposes and using Docker.


To run the application, follow these steps after clone the repo:

- **Run application - Local**
  ```
   python -m venv venv
   source venv/bin/activate
   pip install -r ./setup/requirements.txt
   uvicorn main:app --reload
  ```
- **Run application - Docker**
  ```
   cd setup
   docker-compose -f docker-compose.yml up --build
  ```
### Install ELK - Optional
*Validate elasticDB is running for montioring purposes*
  ```
   docker-compose -f setup/docker-compose_elk.yml up
  ```
  Kibana endpoint URL: http://`hostname`:5601

## 4. Application Monitoring Integration

Application monitoring using the ELK stack, Logstash, and OpenTelemetry;
Enables real-time visualization and analysis of application performance and behavior, scalability.

### Overview

### OpenTelemetry Integration

OpenTelemetry is integrated to capture performance metrics, traces, and logs from FastAPI applications:

- **Metrics:** Captures metrics such as request latency, error rates, and throughput.
- **Traces:** Provides distributed tracing capabilities to monitor request flows across services.
- **Logs:** Integrates logs generated by FastAPI applications and sends them to Elasticsearch via Logstash for unified monitoring.

### ELK Stack

The application leverages the ELK stack (Elasticsearch, Logstash, Kibana) for robust monitoring and visualization of application logs and metrics:

- **Elasticsearch:** Acts as the central data store for storing and indexing logs and metrics.
- **Logstash:** Collects logs from `file.log`, processes them, and sends them to Elasticsearch.
- **Kibana:** Provides a graphical interface for visualizing data stored in Elasticsearch, enabling real-time monitoring and analysis.

#### Kibana Dashboards

Kibana dashboards are customized to visualize application logs, metrics, and traces:

- **Log Analysis:** Provides insights into application behavior, errors, and operational logs.
- **Metrics Visualization:** Charts and graphs display metrics trends, allowing for proactive monitoring and alerting.
- **Trace Analysis:** Traces enable detailed investigation of request flows and dependencies across distributed services.
